**Update：提供了一个脚本（convert.R）将gene symbol转为gene ID。增加了查询功能。**
由于前几日服务器资源比较紧张，程序一运行就会被Kill或者无法分配内存，所以直到今天才得到了测试这个程序的机会。现在这个版本的程序采用的是那个快速版的数据库（就是close时会崩溃的那个）。考虑到我们收集的数据最终都转换为mtx格式了，这个程序是读取mtx文件的。

目前测试结果：已插入30000行，程序稳定。且平均插入每条记录用时维持在6ms上下，看不出随已有行数增多而插入速度变慢的迹象。

使用方法：

1、将dbconn.jar和ref.txt放在同一目录下，再将一组数据的matrix.mtx和gene_ID.tsv也放在该目录下。

如果要进行插入：

2、对matrix.mtx进行预处理，先进行转置，使得列名为基因名，行索引为细胞名，然后打开mtx文件，删除前几行的注释以及描述“行数 列数 非零值数”的那行。（下图红框部分）

3、对gene_ID.tsv进行预处理，使得每一行都是gene ID（ENSG开头的）。

4、运行 dbconn.jar。

5、等待插入完毕。

如果要进行查询：

按照提示进行操作即可，可以自定义查询条件的组数等。需要给定的有条件组数、每组条件所对应的列名和上下界。

<font color=red>已知问题：</font>

1、如果原数据提供的gene_ID.tsv是gene ID形式，那么它用的ensembl库可能是旧版，有的gene ID现在可能被淘汰了。这类问题目前的解决方法是直接忽略掉这些基因对应的项，程序可以自动处理，不需人工干预。

2、如果原数据提供的gene_ID.tsv是gene symbol形式，需要用biomaRt之类的工具转为gene ID。可能有的gene symbol在ensembl库里检索不到，比如AC233755.2（意义不明），导致转换后基因数目变少。
Update：现在的解决方法是提供了一个脚本（convert.R）将gene symbol转为gene ID，且将所有无法检索的gene symbol对应的gene ID对应为ENSG00000000000，这样dbconn.jar会自动筛除。

3、程序不能验证matrix.mtx文件的合法性。

4、关于查询功能：当前数据库里有67140列，每次查询一般用不到全部67140个条件。但是数据库的查询接口似乎不能指定哪些列作为条件，也就是说，每次都要传递67140个条件进去，也有可能是我对接口不熟悉，有待于沟通。
Update：已解决。

5、虽然东方师兄进行了优化，使得数据库的效率大大增加，但是在程序代码中的所有语句执行完毕后，程序退出需要比较长的时间。我不太清楚其中的原理，可能和内存回收有关？但是相比之前的数据库的一些版本，时间已经很短了，算是可以忍受的。也许可以直接Ctrl+C，因为之前已经通过语句把数据存入硬盘了。
Update：此现象属于正常情况。关闭的时候后台在做一些树结构整理的工作，优化结构。
